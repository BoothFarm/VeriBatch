{% extends "base.html" %}

{% block title %}New Event - OriginStack{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Create New Event</h1>
    <p class="text-gray-600 mt-2">Record a production activity</p>
</div>

<div class="max-w-2xl">
    <form method="POST" action="/actors/{{ actor_id }}/events/create" class="bg-white rounded-lg shadow p-6">
        
        <!-- ID -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Event ID *</label>
            <input type="text" name="id" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                   placeholder="e.g., evt-2024-001"
                   required>
        </div>

        <!-- Event Type -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Event Type *</label>
            <select name="event_type" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" required>
                <option value="">Select type...</option>
                <option value="processing">Processing</option>
                <option value="split">Split</option>
                <option value="merge">Merge</option>
                <option value="disposal">Disposal</option>
                <option value="transfer">Transfer</option>
            </select>
        </div>

        <!-- Timestamp -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Timestamp</label>
            <input type="datetime-local" name="timestamp" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
            <p class="text-xs text-gray-500 mt-1">Leave blank for current time</p>
        </div>

        <!-- Performed By -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Performed By</label>
            <input type="text" name="performed_by" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                   placeholder="Person or team name">
        </div>

        <!-- Process -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Process</label>
            <select name="process_id" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                <option value="">None</option>
                {% for process in processes %}
                <option value="{{ process.id }}">{{ process.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Location -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Location</label>
            <select name="location_id" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                <option value="">None</option>
                {% for location in locations %}
                <option value="{{ location.id }}">{{ location.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Inputs -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Input Batches</label>
            <input type="text" name="inputs" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                   placeholder="batch-1, batch-2, batch-3">
            <p class="text-xs text-gray-500 mt-1">Comma-separated batch IDs that were consumed</p>
        </div>

        <!-- Outputs -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Output Batches</label>
            <input type="text" name="outputs" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                   placeholder="batch-10, batch-11">
            <p class="text-xs text-gray-500 mt-1">Comma-separated batch IDs that were created</p>
        </div>

        <!-- Notes -->
        <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
            <textarea name="notes" rows="3" 
                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                      placeholder="Any observations, issues, or details..."></textarea>
        </div>

        <!-- Actions -->
        <div class="flex gap-3">
            <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                Create Event
            </button>
            <a href="/actors/{{ actor_id }}/events" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300">
                Cancel
            </a>
        </div>
    </form>
</div>

{% if not batches %}
<div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
    <p class="text-yellow-800 text-sm">
        ⚠️ No active batches found. <a href="/actors/{{ actor_id }}/batches/new" class="underline font-medium">Create batches first</a> before recording events.
    </p>
</div>
{% endif %}

{% endblock %}
